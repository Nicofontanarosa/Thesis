
-----------------------------------------------------------
* NOTE: This is demo app to show *some* nDPI features.
* In this demo we have implemented only some basic features
* just to show you what you can do with the library. Feel 
* free to extend it and send us the patches for inclusion
------------------------------------------------------------

Using nDPI (4.15.0-5377-8987a2c) [1 thread(s)]
Using libgcrypt version 1.8.6internal
Reading packets from pcap file tesi/pcapng/Hide.me_VPN_Connection_01.pcapng...
Running thread 0...

nDPI Memory statistics:
	nDPI Memory (once):      2.95 KB      
	Flow Memory (per flow):  1.13 KB      
	Actual Memory:           15.33 MB     
	Peak Memory:             15.33 MB     
	Setup Time:              48 msec
	Packet Processing Time:  19 msec

Traffic statistics:
	Ethernet bytes:        7213404       (includes ethernet CRC/IFC/trailer)
	Discarded bytes:       0            
	IP packets:            8849          of 8851 packets total
	IP bytes:              7001028       (avg pkt size 790 bytes)
	Unique flows:          80           
	TCP Packets:           7778         
	UDP Packets:           1071         
	VLAN Packets:          0            
	MPLS Packets:          0            
	PPPoE Packets:         0            
	Fragmented Packets:    0            
	Max Packet size:       1435         
	Packet Len < 64:       2834         
	Packet Len 64-128:     605          
	Packet Len 128-256:    263          
	Packet Len 256-1024:   594          
	Packet Len 1024-1500:  4553         
	Packet Len > 1500:     0            
	nDPI throughput:       443.85 K pps / 2.70 Gb/sec
	Analysis begin:        01/Aug/2025 08:46:51
	Analysis end:          01/Aug/2025 08:47:13
	Traffic throughput:    402.68 pps / 2.50 Mb/sec
	Traffic duration:      21.975 sec
	Guessed flow protos:   7            
	DPI Packets (TCP):     373           (5.49 pkts/flow)
	DPI Packets (UDP):     35            (2.92 pkts/flow)
	Confidence: Unknown    2             (flows)
	Confidence: Match by port 6             (flows)
	Confidence: DPI        71            (flows)
	Confidence: Match by IP 1             (flows)


Detected protocols:
	Unknown              packets: 984           bytes: 509645        flows: 2            
	DNS                  packets: 58            bytes: 9455          flows: 7            
	HTTP                 packets: 7             bytes: 786           flows: 1            
	MDNS                 packets: 18            bytes: 4566          flows: 2            
	DHCP                 packets: 1             bytes: 350           flows: 1            
	TLS                  packets: 125           bytes: 28847         flows: 17           
	Google               packets: 1             bytes: 66            flows: 1            
	WindowsUpdate        packets: 7284          bytes: 6223409       flows: 40           
	QUIC                 packets: 12            bytes: 5736          flows: 1            
	Microsoft            packets: 217           bytes: 169153        flows: 3            
	Microsoft365         packets: 28            bytes: 8904          flows: 1            
	PlayStore            packets: 20            bytes: 8972          flows: 1            
	GoogleServices       packets: 94            bytes: 31139         flows: 3            


Protocol statistics:
	Safe                 packets: 7646          bytes: 6430381       flows: 61           
	Acceptable           packets: 219           bytes: 61002         flows: 17           
	Unrated              packets: 984           bytes: 509645        flows: 2            


Category statistics:
	Unspecified          packets: 984           bytes: 509645        flows: 2            
	Web                  packets: 456           bytes: 235727        flows: 26           
	Download             packets: 6569          bytes: 5798670       flows: 16           
	Network              packets: 77            bytes: 14371         flows: 10           
	Collaborative        packets: 28            bytes: 8904          flows: 1            
	SoftwareUpdate       packets: 735           bytes: 433711        flows: 25           

Risk stats [found 39 (48.8 %) flows with risks]:
	Known Proto on Non Std Port                  3 [ 6.5 %]
	TLS (probably) Not Carrying HTTPS            2 [ 4.3 %]
	Missing SNI TLS Extn                         2 [ 4.3 %]
	Susp Entropy                                 1 [ 2.2 %]
	Error Code                                  10 [21.7 %]
	Unidirectional Traffic                       7 [15.2 %]
	Minor Issues                                 1 [ 2.2 %]
	TCP Connection Issues                        1 [ 2.2 %]
	ALPN/SNI Mismatch                            2 [ 4.3 %]
	Binary File/Data Transfer (Attempt)         16 [34.8 %]
	Probing Attempt                              1 [ 2.2 %]

	NOTE: as one flow can have multiple risks set, the sum of the
	      last column can exceed the number of flows with risks.



JA Host Stats: 
		 IP Address                  	 # JA4C     
	1	 192.168.70.96            	 8      

	# IP VPN
	36	TCP 192.168.70.96:61760 <-> 45.76.88.89:443 [proto: 91/TLS][IP: 0/Unknown][Encrypted][Confidence: DPI][FPC: 0/Unknown, Confidence: Unknown][DPI packets: 6][cat: Web/5][10 pkts/1577 bytes <-> 9 pkts/1295 bytes][Goodput ratio: 58/53][0.46 sec][Hostname/SNI: api.hide.me][(Advertised) ALPNs: h2;http/1.1][TLS Supported Versions: TLSv1.3;TLSv1.2][bytes ratio: 0.098 (Mixed)][IAT c2s/s2c min/avg/max/stddev: 0/0 45/51 101/105 33/41][Pkt Len c2s/s2c min/avg/max/stddev: 66/66 158/144 583/349 162/102][TCP Fingerprint: 2_64_65535_41a9d5af7dd3/Android][TLSv1.3][JA4: t13d1514h2_8daaf6152771_fadfdae04b4e][JA3S: fcb2d4d0991292272fcb1e464eedfd43][Safari][Cipher: TLS_AES_128_GCM_SHA256][Plen Bins: 30,10,20,0,0,0,0,10,20,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	37	TCP 192.168.70.96:61762 <-> 45.76.88.89:443 [proto: 91/TLS][IP: 0/Unknown][Encrypted][Confidence: DPI][FPC: 0/Unknown, Confidence: Unknown][DPI packets: 6][cat: Web/5][9 pkts/1493 bytes <-> 8 pkts/1210 bytes][Goodput ratio: 60/56][0.58 sec][Hostname/SNI: api.hide.me][(Advertised) ALPNs: h2;http/1.1][TLS Supported Versions: TLSv1.3;TLSv1.2][bytes ratio: 0.105 (Mixed)][IAT c2s/s2c min/avg/max/stddev: 0/0 68/61 155/154 59/63][Pkt Len c2s/s2c min/avg/max/stddev: 66/66 166/151 583/330 170/100][TCP Fingerprint: 2_64_65535_41a9d5af7dd3/Android][TLSv1.3][JA4: t13d1514h2_8daaf6152771_fadfdae04b4e][JA3S: fcb2d4d0991292272fcb1e464eedfd43][Safari][Cipher: TLS_AES_128_GCM_SHA256][Plen Bins: 22,11,22,0,0,0,0,11,22,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	
	# IP FLUSSO DATI VPN
	15	TCP 192.168.70.96:61765 <-> 144.76.154.14:432 [proto: 91/TLS][IP: 0/Unknown][Encrypted][Confidence: DPI][FPC: 0/Unknown, Confidence: Unknown][DPI packets: 6][cat: Web/5][15 pkts/2016 bytes <-> 17 pkts/8750 bytes][Goodput ratio: 52/87][0.67 sec][(Advertised) ALPNs: h2;http/1.1][TLS Supported Versions: TLSv1.3;TLSv1.2][bytes ratio: -0.625 (Download)][IAT c2s/s2c min/avg/max/stddev: 0/0 24/38 106/195 35/59][Pkt Len c2s/s2c min/avg/max/stddev: 54/66 134/515 738/1394 173/585][Risk: ** Known Proto on Non Std Port **** Missing SNI TLS Extn **** ALPN/SNI Mismatch **][Risk Score: 150][Risk Info: h2 / SNI should always be present / Expected on port 443][TCP Fingerprint: 2_64_65535_41a9d5af7dd3/Android][TLSv1.3][JA4: t13d1511h2_8daaf6152771_40271e0a5736][JA3S: f4febc55ea12b31ae17cfb7e614afda8][Safari][Cipher: TLS_AES_128_GCM_SHA256][Plen Bins: 24,11,11,0,5,0,0,5,0,0,0,0,0,0,0,0,0,0,0,5,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0]
	16	TCP 192.168.70.96:61763 <-> 144.76.154.14:432 [proto: 91/TLS][IP: 0/Unknown][Encrypted][Confidence: DPI][FPC: 0/Unknown, Confidence: Unknown][DPI packets: 6][cat: Web/5][18 pkts/1997 bytes <-> 18 pkts/8613 bytes][Goodput ratio: 41/86][0.91 sec][(Advertised) ALPNs: h2;http/1.1][TLS Supported Versions: TLSv1.3;TLSv1.2][bytes ratio: -0.624 (Download)][IAT c2s/s2c min/avg/max/stddev: 0/0 25/50 103/186 35/72][Pkt Len c2s/s2c min/avg/max/stddev: 54/66 111/478 509/1394 113/572][Risk: ** Known Proto on Non Std Port **** Missing SNI TLS Extn **** ALPN/SNI Mismatch **][Risk Score: 150][Risk Info: h2 / SNI should always be present / Expected on port 443][TCP Fingerprint: 2_64_65535_41a9d5af7dd3/Android][TLSv1.3][JA4: t13d1511h2_8daaf6152771_40271e0a5736][JA3S: f4febc55ea12b31ae17cfb7e614afda8][Safari][Cipher: TLS_AES_128_GCM_SHA256][Plen Bins: 22,11,11,0,11,0,0,5,5,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0]
	
	# HTTP
	60	TCP 192.168.70.96:61758 <-> 151.5.24.33:80 [proto: 7/HTTP][IP: 0/Unknown][ClearText][Confidence: DPI][FPC: 0/Unknown, Confidence: Unknown][DPI packets: 6][cat: Web/5][4 pkts/396 bytes <-> 3 pkts/390 bytes][Goodput ratio: 31/47][0.12 sec][Hostname/SNI: www.msftncsi.com][bytes ratio: 0.008 (Mixed)][IAT c2s/s2c min/avg/max/stddev: 0/4 41/29 79/54 32/25][Pkt Len c2s/s2c min/avg/max/stddev: 66/66 99/130 190/250 53/85][URL: www.msftncsi.com/ncsi.txt][StatusCode: 200][Content-Type: text/plain][User-Agent: okhttp/4.11.0][TCP Fingerprint: 2_64_65535_41a9d5af7dd3/Android][PLAIN TEXT (GET /ncsi.t)][Plen Bins: 0,0,0,50,0,50,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	
	# DNS
	38	UDP [fe80::d9a6:c8b:2523:951d]:5353 -> [ff02::fb]:5353 [proto: 8/MDNS][IP: 0/Unknown][ClearText][Confidence: DPI][FPC: 8/MDNS, Confidence: DPI][DPI packets: 3][cat: Network/14][9 pkts/2373 bytes -> 0 pkts/0 bytes][Goodput ratio: 76/0][3.00 sec][Hostname/SNI: _dosvc._tcp.local][_dosvc._tcp.local][bytes ratio: 1.000 (Upload)][IAT c2s/s2c min/avg/max/stddev: 0/0 375/0 1231/0 447/0][Pkt Len c2s/s2c min/avg/max/stddev: 97/0 264/0 495/0 184/0][PLAIN TEXT (x/GZGdAjpH)][Plen Bins: 0,55,0,0,0,0,0,0,0,0,0,22,0,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	39	UDP 192.168.70.96:58777 <-> 192.168.70.69:53 [proto: 5/DNS][IP: 0/Unknown][ClearText][Confidence: DPI][FPC: 5/DNS, Confidence: DPI][DPI packets: 6][cat: Network/14][8 pkts/696 bytes <-> 8 pkts/1637 bytes][Goodput ratio: 52/79][3.15 sec][Hostname/SNI: free-de-v4.hideservers.net][144.76.154.16][DNS Id: 0x5a32][bytes ratio: -0.403 (Download)][IAT c2s/s2c min/avg/max/stddev: 10/11 504/508 1239/1198 517/499][Pkt Len c2s/s2c min/avg/max/stddev: 76/76 87/205 95/327 5/99][Risk: ** Error Code **** Minor Issues **][Risk Score: 20][Risk Info: DNS Record with zero TTL / DNS Error Code NXDOMAIN][PLAIN TEXT (myipstack)][Plen Bins: 0,69,0,0,0,12,0,0,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	41	UDP 192.168.70.96:5353 -> 224.0.0.251:5353 [proto: 8/MDNS][IP: 0/Unknown][ClearText][Confidence: DPI][FPC: 8/MDNS, Confidence: DPI][DPI packets: 3][cat: Network/14][9 pkts/2193 bytes -> 0 pkts/0 bytes][Goodput ratio: 83/0][3.00 sec][Hostname/SNI: _dosvc._tcp.local][_dosvc._tcp.local][bytes ratio: 1.000 (Upload)][IAT c2s/s2c min/avg/max/stddev: 0/0 375/0 1231/0 447/0][Pkt Len c2s/s2c min/avg/max/stddev: 77/0 244/0 475/0 184/0][PLAIN TEXT (x/GZGdAjpH)][Plen Bins: 0,55,0,0,0,0,0,0,0,0,0,22,0,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	57	UDP 192.168.70.96:50477 <-> 192.168.70.69:53 [proto: 5/DNS][IP: 0/Unknown][ClearText][Confidence: DPI][FPC: 5/DNS, Confidence: DPI][DPI packets: 2][cat: Network/14][4 pkts/380 bytes <-> 3 pkts/813 bytes][Goodput ratio: 56/84][0.35 sec][Hostname/SNI: 1d.tlu.dl.delivery.mp.microsoft.com][151.101.242.172][DNS Id: 0xcae8][bytes ratio: -0.363 (Download)][IAT c2s/s2c min/avg/max/stddev: 33/31 62/150 97/268 26/118][Pkt Len c2s/s2c min/avg/max/stddev: 95/271 95/271 95/271 0/0][PLAIN TEXT (delivery)][Plen Bins: 0,57,0,0,0,0,0,42,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	58	UDP 192.168.70.96:58287 <-> 192.168.70.69:53 [proto: 5/DNS][IP: 0/Unknown][ClearText][Confidence: DPI][FPC: 5/DNS, Confidence: DPI][DPI packets: 2][cat: Network/14][3 pkts/280 bytes <-> 3 pkts/654 bytes][Goodput ratio: 55/81][0.64 sec][Hostname/SNI: cp601.prod.do.dsp.mp.microsoft.com][23.60.190.42][DNS Id: 0xba48][bytes ratio: -0.400 (Download)][IAT c2s/s2c min/avg/max/stddev: 122/89 314/293 506/497 192/204][Pkt Len c2s/s2c min/avg/max/stddev: 91/179 93/218 95/271 2/39][PLAIN TEXT (microsoft)][Plen Bins: 0,51,0,0,16,16,0,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	62	UDP 192.168.70.96:53358 <-> 192.168.70.69:53 [proto: 5/DNS][IP: 0/Unknown][ClearText][Confidence: DPI][FPC: 5/DNS, Confidence: DPI][DPI packets: 2][cat: Network/14][1 pkts/89 bytes <-> 1 pkts/226 bytes][Goodput ratio: 52/81][0.05 sec][Hostname/SNI: v10.events.data.microsoft.com][20.42.73.31][DNS Id: 0x41b3][PLAIN TEXT (events)][Plen Bins: 0,50,0,0,0,50,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	63	UDP 192.168.70.96:52352 <-> 192.168.70.69:53 [proto: 5/DNS][IP: 0/Unknown][ClearText][Confidence: DPI][FPC: 5/DNS, Confidence: DPI][DPI packets: 2][cat: Network/14][1 pkts/95 bytes <-> 1 pkts/206 bytes][Goodput ratio: 55/79][0.05 sec][Hostname/SNI: geover.prod.do.dsp.mp.microsoft.com][23.60.189.217][DNS Id: 0xa4e4][PLAIN TEXT (geover)][Plen Bins: 0,50,0,0,0,50,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	64	UDP 192.168.70.96:51359 <-> 192.168.70.69:53 [proto: 5/DNS][IP: 0/Unknown][ClearText][Confidence: DPI][FPC: 5/DNS, Confidence: DPI][DPI packets: 2][cat: Network/14][1 pkts/76 bytes <-> 1 pkts/182 bytes][Goodput ratio: 44/77][0.05 sec][Hostname/SNI: www.msftncsi.com][151.5.24.33][DNS Id: 0x9c9f][PLAIN TEXT (msftncsi)][Plen Bins: 0,50,0,0,50,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	35	UDP 192.168.70.96:53367 <-> 192.168.70.69:53 [proto: 5/DNS][IP: 0/Unknown][ClearText][Confidence: DPI][FPC: 5/DNS, Confidence: DPI][DPI packets: 2][cat: Network/14][12 pkts/1140 bytes <-> 11 pkts/2981 bytes][Goodput ratio: 56/84][3.68 sec][Hostname/SNI: 1d.tlu.dl.delivery.mp.microsoft.com][151.101.242.172][DNS Id: 0x781f][bytes ratio: -0.447 (Download)][IAT c2s/s2c min/avg/max/stddev: 10/12 355/388 1268/1264 487/505][Pkt Len c2s/s2c min/avg/max/stddev: 95/271 95/271 95/271 0/0][PLAIN TEXT (delivery)][Plen Bins: 0,52,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	

Undetected flows:

	# FLUSSO VPN
	1	UDP 192.168.70.96:61766 <-> 144.76.154.14:412 [proto: 0/Unknown][IP: 0/Unknown][ClearText][Confidence: Unknown][FPC: 0/Unknown, Confidence: Unknown][DPI packets: 7][518 pkts/143761 bytes <-> 464 pkts/365756 bytes][Goodput ratio: 85/95][16.09 sec][bytes ratio: -0.436 (Download)][IAT c2s/s2c min/avg/max/stddev: 0/0 27/13 2068/467 130/42][Pkt Len c2s/s2c min/avg/max/stddev: 75/74 278/788 1469/1465 347/598][Risk: ** Susp Entropy **][Risk Score: 10][Risk Info: Entropy: 6.251 (Executable?)][Plen Bins: 0,1,2,47,13,2,6,1,1,0,1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,9,0,0,0]
	2	TCP 192.168.70.96:61761 <-> 144.76.154.16:8443 [proto: 0/Unknown][IP: 0/Unknown][ClearText][Confidence: Unknown][FPC: 0/Unknown, Confidence: Unknown][DPI packets: 2][1 pkts/74 bytes <-> 1 pkts/54 bytes][Goodput ratio: 0/0][0.06 sec][Risk: ** TCP Connection Issues **** Probing Attempt **][Risk Score: 100][Risk Info: TCP probing attempt / Connection refused (server)][TCP Fingerprint: 2_64_65535_41a9d5af7dd3/Android][Plen Bins: 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
